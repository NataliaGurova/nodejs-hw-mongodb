Завдання

Вам потрібно створити додаток для роботи з колекцією контактів, в якому можна буде за допомогою HTTP запитів отримувати дані всіх контактів або одного по id.

Файл з даними для завантаження:

contacts.json



Критерії прийому

Створено репозиторій nodejs-hw-mongodb
Завдання виконано на гілці hw2-mongodb
При здачі домашньої роботи є посилання на вихідні файли на Github та посилання на задеплоєний проєкт цієї ДЗ (гілка hw2-mongodb) на render.com
При виконані коду завдання немає помилок


Покрокове виконання завдання



Крок 1



Ініціалізуйте проєкт командою npm init -y

Додайте в залежності проєкта eslint та підкорегуй його конфігураційний файл згідно наданого прикладу в матеріалах

Додайте у корінь проєкта файли .gitignore та .prettierrc з відповідним вмістом



Крок 2



Створіть в корні проєкта папку src.

В папці src створіть файл із назвою server.js. В ньому буде знаходитись логіка роботи вашого express-серверу.

В файлі src/server.js створіть функцію setupServer, в якій буде створюватись express сервер. Ця функція має в себе включати:

Створення серверу за допомогою виклику express()
Налаштування cors та логгера pino.
Обробку неіснуючих роутів (повертає статус 404 і відповідне повідомлення)
{
  message: 'Not found',
}

Запуск серверу на порті, вказаному через змінну оточення PORT або 3000, якщо такої змінної не зазначено
При вдалому запуску сервера виводити в консоль рядок “Server is running on port {PORT}”, де {PORT} - це номер вашого порта
Не забудьте вказати змінну оточення в файлі .env.example

Створіть файл src/index.js. Імпортуйте і викличте у ньому функцію setupServer.



Крок 3



Створіть свій кластер в mongodb та функцію initMongoConnection для встановлення зʼєднання з нею в окремому файлі src/db/initMongoConnection.js. При вдалому підключенні до вашої базі в mongodb виводьте в консоль рядок "Mongo connection successfully established!".

Дані для підключення до бази мають бути винесені в наступні змінні оточення:

MONGODB_USER
MONGODB_PASSWORD
MONGODB_URL
MONGODB_DB
Вкажіть ці змінні оточення в файлі .env.example

Для роботи з mongodb використовуйте пакет mongoose.
npm install mongoose

У файлі src/index.js викличте функції initMongoConnection. Переконайтеся, що зʼєднання із базою встановлюється до запуску серверу.



Крок 4



В папці src/db створіть модель контакту Contact, що буде включати в себе такі поля:

name - string, required
phoneNumber - string, required
email - email, optional
isFavourite - boolean, default false
contactType - string, enum(’work’, ‘home’, ‘personal’), required, default ‘personal’
createdAt - дата створення
updatedAt - дата оновлення
Для останніх двух полів можна використати параметр timestamps: true при створенні моделі.

contacts.json



Імпортуйте базовий набір контактів із файлу contacts.json до вашої бази, користуючись будь-яким UI інтерфейсом (в браузері, Mongo Compass тощо). Переконайтеся, що назва колекції в коді моделі та в візуальному інтерфейсі співпадають.



Крок 5



Створіть роут GET /contacts, який буде повертати масив усіх контактів. Обробка цього роута має включати:

Реєстрацію роута в файлі src/server.js
Опис контролера для цього роута
Створення сервісу в папці src/services у файлі із відповідним сутності іменем(в данному випадку contacts.js)
Відповідь сервера має містити об’єкт з наступними властивостями:
status — статус відповіді
message — повідомлення про результат виконання операції "Successfully found contacts!"
data — дані, отримані в результаті обробки запиту


Крок 6



Аналогічно створіть роут GET /contacts/:contactId, який буде повертати дані контакта з переданим ID або повертати помилку 404, якщо контакт не знайдено. Формат відповіді має відповідати формату успішної відповіді "Successfully found contact with id {contactId}!"



Крок 7



Задеплойте ваш додаток з гілки hw2-mongodb на render.com. Покрокова інструкція як це зробити є в цьому відео:

//=====================================
